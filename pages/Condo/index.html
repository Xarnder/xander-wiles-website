<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>3D First Person Viewer</title>
  <link rel="stylesheet" href="./style.css" />
  <link rel="icon" href="images/favicon.svg" type="image/svg+xml"/>
</head>
<body>
  <div id="ui" class="">
    <div class="header">
      <button id="btnCollapse" title="Collapse/expand menu (M)">▾</button>
      <button id="btnCloseMenu" title="Close Menu">×</button> <!-- ADD THIS LINE -->
      <strong>Controls</strong>
      <div class="spacer"></div>
      <div class="fps">FPS: <span id="fps">--</span></div>
      <button id="btnDebug" title="Toggle debug panel (Backtick)">Debug</button>
    </div>
    <div class="body" id="ui-body">
      <!-- Scene Selection -->
      <details class="row" open>
        <summary><strong>Scene Selection</strong></summary>
        <div class="row">
          <label for="sceneSelector">Current Scene</label><br/>
          <select id="sceneSelector"></select>
        </div>
      </details>
      
      <!-- Main Toggles -->
      <div class="row">
        <label><input id="toggleCollision" type="checkbox" /> Show collision scene <span class="small"> (H)</span></label>
      </div>
      <div class="row">
        <label><input id="toggleFly" type="checkbox" /> Fly mode (no gravity) <span class="small"> (F)</span></label>
      </div>

      <!-- Player Settings Sub-menu -->
      <details class="row">
        <summary><strong>Player Settings</strong></summary>
        <div class="row">
          <label for="moveSpeed">Movement Speed</label><br/>
          <input id="moveSpeed" type="range" min="1" max="15" step="0.1" value="4.0" />
          <span id="moveSpeedValue" class="small">4.0</span>
        </div>
        <div class="row">
          <label for="jumpHeight">Jump Power</label><br/>
          <input id="jumpHeight" type="range" min="1" max="15" step="0.1" value="5.5" />
          <span id="jumpHeightValue" class="small">5.5</span>
        </div>
        <div class="row">
          <label for="playerHeight">Player Height</label><br/>
          <input id="playerHeight" type="range" min="1.0" max="3.0" step="0.05" value="1.6" />
          <span id="playerHeightValue" class="small">1.60 m</span>
        </div>
        <div class="row">
          <label for="playerWidth">Player Width (Radius)</label><br/>
          <input id="playerWidth" type="range" min="0.2" max="1.0" step="0.01" value="0.35" />
          <span id="playerWidthValue" class="small">0.35 m</span>
        </div>
      </details>
      
      <!-- Visual Settings Sub-menu -->
      <details class="row">
        <summary><strong>Visual Settings</strong></summary>
        <div class="row">
          <label for="exposure"><strong>Exposure</strong> <span class="small">(dims all lighting)</span></label><br/>
          <input id="exposure" type="range" min="0.01" max="2.00" step="0.01" value="0.25" />
          <span id="exposureValue" class="small">0.25</span>
        </div>
        <div class="row">
          <label for="fovSlider">Field of View (FOV)</label><br/>
          <input id="fovSlider" type="range" min="30" max="110" step="1" value="75" />
          <span id="fovValue" class="small">75</span>
        </div>
        <details class="row" open>
          <summary><strong>Advanced lighting</strong></summary>
          <div class="row">
            <label for="lightScale">Light Intensity Scale <span class="small">(0 → 0.01)</span></label><br/>
            <input id="lightScale" type="range" min="0.0000" max="0.0100" step="0.0001" value="0.0020" />
            <span id="lightScaleValue" class="small">0.0020</span>
          </div>
        </details>
        <details class="row" open>
          <summary><strong>Performance &amp; Quality</strong></summary>
          <div class="row">
            <label><input id="toggleHQLighting" type="checkbox" checked /> High Quality Lighting <span class="small">(shadows, env map)</span></label>
          </div>
          <div class="row">
            <label for="shadowQuality">Shadow Quality</label><br/>
            <input id="shadowQuality" type="range" min="0" max="3" step="1" value="2" />
            <span id="shadowQualityValue" class="small">Medium</span>
          </div>
        </details>
      </details>

      <div class="row small">
        Click canvas • WASD move • Space jump • Shift sprint • E/Q up/down in fly • R respawn • M menu • ` debug
      </div>
      <div class="row small">
        <span id="status">Initializing...</span>
      </div>
    </div>
  </div>

  <pre id="debug"></pre>
  <canvas id="c"></canvas>

  <script type="importmap">
  {
    "imports": {
      "three": "https://unpkg.com/three@0.159.0/build/three.module.js",
      "three/addons/": "https://unpkg.com/three@0.159.0/examples/jsm/",
      "cannon-es": "https://cdn.jsdelivr.net/npm/cannon-es@0.20.0/dist/cannon-es.js"
    }
  }
  </script>
  <script type="module" src="./main.js"></script>
</body>
</html>