<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Convolution Explorer</title>

    <!-- Theme-aware SVG icons (modern browsers) -->
    <link rel="icon" href="favicon.ico" sizes="any"> <!-- Fallback for older browsers -->
    <link rel="icon" href="favicon-light.svg" type="image/svg+xml" media="(prefers-color-scheme: light)">
    <link rel="icon" href="favicon-dark.svg" type="image/svg+xml" media="(prefers-color-scheme: dark)">

    <!-- Fallback PNG icons -->
    <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">

    <!-- Other essential links -->
    <link rel="manifest" href="site.webmanifest">
    <meta name="theme-color" content="#ffffff" media="(prefers-color-scheme: light)">
    <meta name="theme-color" content="#111115" media="(prefers-color-scheme: dark)">

    <!-- Global Site Header Styles -->
    <link rel="stylesheet" href="/assets/css/style.css">

    <!-- Tool Specific Styles -->
    <link rel="stylesheet" href="style.css">
</head>

<body>

    <!-- Global Navigation Placeholder -->
    <div id="main-nav-placeholder"></div>
    <script src="/assets/js/nav-loader.js"></script>

    <!-- Main Tool Container -->
    <main class="container">
        <header class="tool-header">
            <h1>Interactive Convolution Visualizer</h1>
            <p>Understand how Kernels transform Input Matrices</p>
        </header>

        <!-- Controls Section -->
        <section class="controls-card glass-panel">
            <div class="control-group">
                <label for="gridSize">Grid Size (N x N)</label>
                <input type="number" id="gridSize" min="3" max="32" value="5">
            </div>

            <div class="control-group">
                <label for="modeSelect">Mode</label>
                <select id="modeSelect">
                    <option value="numerical">Numerical Grid</option>
                    <option value="image">Image Processing</option>
                </select>
            </div>

            <div class="control-group" id="fileUploadGroup" style="display: none;">
                <label for="imageUpload">Upload Image</label>
                <input type="file" id="imageUpload" accept="image/*">
            </div>

            <div class="control-group">
                <label for="rangeToggle">Value Range</label>
                <select id="rangeToggle">
                    <option value="10">0 - 10 (Simple)</option>
                    <option value="255">0 - 255 (Grayscale)</option>
                </select>
            </div>

            <div class="control-group">
                <label for="kernelSelect">Kernel / Filter</label>
                <select id="kernelSelect">
                    <option value="identity">Identity</option>
                    <option value="shiftLeft">Shift Left</option>
                    <option value="shiftRight">Shift Right</option>
                    <option value="shiftUp">Shift Up</option>
                    <option value="shiftDown">Shift Down</option>
                    <option value="edge1">Edge Detection 1</option>
                    <option value="edge2">Edge Detection 2</option>
                    <option value="sharpen">Sharpen</option>
                    <option value="boxBlur">Box Blur</option>
                    <option value="gaussian">Gaussian Blur 3x3</option>
                </select>
            </div>

            <div class="control-group checkbox-group">
                <input type="checkbox" id="paddingCheck">
                <label for="paddingCheck">Use Padding (Zero-padding)</label>
            </div>

            <button id="refreshBtn" class="btn-action">Generate New Input</button>
        </section>

        <!-- Visualization Section -->
        <section class="vis-container">

            <!-- Input Grid -->
            <div class="stage">
                <h3>Input Image</h3>
                <div class="info-tag" id="inputDims">5x5</div>
                <div id="inputGrid" class="grid-display glass-panel"></div>
                <!-- Canvas for Image Mode -->
                <canvas id="inputCanvas" class="glass-panel" style="display: none;"></canvas>
            </div>

            <!-- Operator -->
            <div class="operator">
                <span>*</span> <!-- Convolution Symbol -->
                <div class="kernel-display glass-panel">
                    <h4>Kernel</h4>
                    <div id="kernelGrid" class="grid-kernel"></div>
                </div>
                <span>=</span>
            </div>

            <!-- Output Grid -->
            <div class="stage">
                <h3>Output Feature Map</h3>
                <div class="info-tag" id="outputDims">3x3</div>
                <div id="outputGrid" class="grid-display glass-panel"></div>
                <!-- Canvas for Image Mode -->
                <canvas id="outputCanvas" class="glass-panel" style="display: none;"></canvas>
            </div>

        </section>

        <!-- Calculation Breakdown Panel -->
        <section id="calcBreakdown" class="calc-panel glass-panel" style="display: none;">
            <h3>Calculation Breakdown</h3>
            <div id="calcContent" class="calc-content">Select an output cell to see the math.</div>
        </section>

        <!-- Debug / Console Output on Screen -->
        <section class="debug-panel glass-panel">
            <h3>Debug Log</h3>
            <div id="debugLog"></div>
        </section>

    </main>

    <script src="script.js"></script>
</body>

</html>