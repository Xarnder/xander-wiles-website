<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Arkonhex</title>
    <link rel="stylesheet" href="style.css">

    <!-- Theme-aware SVG icons (modern browsers) -->
    <link rel="icon" href="favicon.ico" sizes="any"> <!-- Fallback for older browsers -->
    <link rel="icon" href="favicon-light.svg" type="image/svg+xml" media="(prefers-color-scheme: light)">
    <link rel="icon" href="favicon-dark.svg" type="image/svg+xml" media="(prefers-color-scheme: dark)">

    <!-- Fallback PNG icons -->
    <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">

    <!-- Other essential links -->
    <link rel="manifest" href="site.webmanifest">
    <meta name="theme-color" content="#ffffff" media="(prefers-color-scheme: light)">
    <meta name="theme-color" content="#111115" media="(prefers-color-scheme: dark)">

    <!-- Three.js Import Map -->
    <script type="importmap">
    {
        "imports": {
            "three": "https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.module.js",
            "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.160.0/examples/jsm/"
        }
    }
    </script>
</head>

<body>
    <div id="game-container"></div>

    <!-- UI Overlay container -->
    <div id="ui-layer" class="ui-hidden">
        <div id="crosshair"></div>
        <div id="dev-info">
            Arkonhex <span id="system-date"></span> - <span id="in-game-time">12:00 AM</span> - v0.1.0 Alpha
        </div>
        <div id="debug-overlay">
            <div id="fps-counter">FPS: 0</div>
            <div id="seed-display">Seed: 0</div>
            <div id="selected-block-info">Selected: None</div>
        </div>
        <div id="hotbar" class="hotbar">
            <!-- Items injected by UI manager -->
        </div>

        <div id="start-screen" class="overlay-screen">
            <h1>ARKONHEX</h1>
            <div id="loading-container">
                <div id="loading-text">Initializing Engine...</div>
                <div id="loading-bar-border">
                    <div id="loading-bar-fill"></div>
                </div>
            </div>
            <p id="start-hint" style="display: none; cursor: pointer;">Click to Start</p>
            <p>Controls: WASD to move, Space to Jump, Shift to Sprint. Click to Break, Right Click to Place.</p>
        </div>

        <div id="pause-screen" class="overlay-screen hidden"
            onclick="if (!document.pointerLockElement) document.body.requestPointerLock()">
            <div style="pointer-events: none;">
                <h1 style="pointer-events: auto;">Game Paused</h1>
            </div>
            <div class="pause-tabs" style="margin-top: 10px; pointer-events: auto;">
                <button class="pause-tab active" data-tab="settings-tab"
                    onclick="event.stopPropagation()">Settings</button>
                <button class="pause-tab" data-tab="inventory-tab" onclick="event.stopPropagation()">Inventory</button>
            </div>

            <div id="settings-tab" class="settings-panel tab-content active" style="pointer-events: auto;"
                onclick="event.stopPropagation()">
                <div class="setting-row">
                    <label>Render Distance: <span id="rd-val">8</span> Chunks</label>
                    <input type="range" id="rd-slider" min="2" max="16" step="1" value="8">
                    <p style="font-size:0.8em; color: #ff5555; margin-top:5px;">Warning: Higher values severely impact
                        FPS.</p>
                </div>

                <div class="setting-row" style="margin-top: 20px;">
                    <label>Field of View: <span id="fov-val">75</span></label>
                    <input type="range" id="fov-slider" min="60" max="120" step="1" value="75">
                </div>

                <div class="setting-row" style="margin-top: 20px;">
                    <label>Cloud Shadows: <input type="checkbox" id="cloud-shadows-toggle"></label>
                </div>

                <div class="setting-row" style="margin-top: 20px;">
                    <label>AOC Strength: <span id="aoc-val">0.8</span></label>
                    <input type="range" id="aoc-slider" min="0.0" max="1.0" step="0.1" value="0.8">
                    <p style="font-size:0.8em; color: #888888; margin-top:5px;">Ambient Occlusion blending. Requires
                        High Graphics (G) to be enabled.</p>
                </div>

                <div class="setting-row" style="margin-top: 20px;">
                    <label>GTAO Post-Processing: <span id="gtao-val">1.0</span></label>
                    <input type="range" id="gtao-slider" min="0.0" max="2.0" step="0.1" value="1.0">
                    <p style="font-size:0.8em; color: #ff5555; margin-top:5px;">Ground Truth Screen-Space Shadows.
                        Massive performance hit.</p>
                </div>

                <div class="setting-row" style="margin-top: 20px;">
                    <label>Terrain Shadow Resolution:
                        <select id="shadow-res-select"
                            style="margin-left: 10px; padding: 5px; background: #333; color: white; border: 1px solid #555; border-radius: 4px;">
                            <option value="1024">Low (1024)</option>
                            <option value="2048">Medium (2048)</option>
                            <option value="4096" selected>High (4096)</option>
                            <option value="8192">Ultra (8192)</option>
                        </select>
                    </label>
                    <p style="font-size:0.8em; color: #888888; margin-top:5px;">Requires High Graphics (G) to be active.
                        Lower to vastly improve framerate.</p>
                </div>

                <div class="setting-row" style="margin-top: 20px;">
                    <label>Block Outlines: <input type="checkbox" id="block-outline-toggle"></label>
                    <p style="font-size:0.8em; color: #888888; margin-top:5px;">Draws sharp outlines around all blocks.
                        Adds a slight performance cost.</p>
                </div>
            </div>

            <div id="inventory-tab" class="settings-panel tab-content" style="pointer-events: auto;"
                onclick="event.stopPropagation()">
                <h2 style="margin-top: 0;">Inventory</h2>
                <p style="opacity: 0.7;">Inventory system coming soon...</p>
            </div>

            <p style="margin-top:20px; pointer-events: none;">Click anywhere outside to resume.</p>
        </div>
    </div>

    <!-- Water submersion overlay â€” must live OUTSIDE #ui-layer to avoid ui-hidden suppression -->
    <div id="water-overlay" class="hidden" style="
        position: fixed;
        top: 0; left: 0;
        width: 100%; height: 100%;
        background-color: rgba(0, 50, 150, 0.4);
        pointer-events: none;
        z-index: 20;
        display: none;
    "></div>

    <!-- Main Entry script -->
    <script type="module" src="src/core/Engine.js"></script>
</body>

</html>